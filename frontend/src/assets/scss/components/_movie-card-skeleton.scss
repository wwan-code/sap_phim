@use '../_variables' as *;
@use '../_mixins' as *;

// Keyframe animation cho shimmer effect
@keyframes shimmer {
    0% {
        background-position: -200px 0;
    }

    100% {
        background-position: calc(200px + 100%) 0;
    }
}

// Base skeleton shimmer mixin
@mixin skeleton-shimmer($width: 100%, $height: 16px, $border-radius: var(--w-border-radius)) {
    width: $width;
    height: $height;
    background: linear-gradient(90deg,
            var(--w-background-color-dark) 25%,
            var(--w-border-color) 50%,
            var(--w-background-color-dark) 75%);
    background-size: 200px 100%;
    animation: shimmer 1.5s infinite linear;
    border-radius: $border-radius;
}

.skeleton-shimmer {
    @include skeleton-shimmer();
}

.movie-card-skeleton {
    display: block;
    background-color: transparent;
    border-radius: var(--w-border-radius-lg);
    overflow: hidden;
    position: relative;

    &__cover-wrap {
        position: relative;
        padding-top: 150%;
        aspect-ratio: 2 / 3;
        background-color: var(--w-background-color-dark);
        border-radius: var(--w-border-radius-lg);
        overflow: hidden;

        .movie-card-skeleton--horizontal & {
            padding-top: 56.25%;
            aspect-ratio: 16 / 9;
        }
    }

    &__image {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        @include skeleton-shimmer(100%, 100%, var(--w-border-radius-lg));
    }

    &__info {
        padding: var(--w-spacing-sm) 0;
    }

    &__title {
        @include skeleton-shimmer(85%, 20px, var(--w-border-radius));
        margin-bottom: var(--w-spacing-sm);
    }

    &__meta {
        @include flex(row, flex-start, center);
        gap: var(--w-spacing-sm);
    }

    &__year {
        @include skeleton-shimmer(40px, 14px, var(--w-border-radius));
    }

    &__quality {
        @include skeleton-shimmer(50px, 20px, var(--w-border-radius));
    }

    // Mini version styling
    &--mini {
        @include flex(row, flex-start, stretch);
        gap: var(--w-spacing-md);

        .movie-card-skeleton__cover-wrap {
            flex-shrink: 0;
            width: 120px;
            padding-top: 67.5%; // 16:9 aspect ratio for episodes
            height: 68px; // Fixed height for mini version
        }

        .movie-card-skeleton__info {
            padding: 0;
            flex: 1;
            @include flex(column, center, flex-start);
        }

        .movie-card-skeleton__title {
            @include skeleton-shimmer(80%, 16px, var(--w-border-radius));
            margin-bottom: var(--w-spacing-xs);
        }

        .movie-card-skeleton__year {
            @include skeleton-shimmer(35px, 12px, var(--w-border-radius));
        }

        .movie-card-skeleton__quality {
            @include skeleton-shimmer(45px, 16px, var(--w-border-radius));
        }
    }

    // Dark theme adjustments
    [data-ww-theme="dark"] & {

        .skeleton-shimmer,
        &__image,
        &__title,
        &__year,
        &__quality {
            background: linear-gradient(90deg,
                    var(--w-background-color-light) 25%,
                    var(--w-border-color) 50%,
                    var(--w-background-color-light) 75%);
            background-size: 200px 100%;
            animation: shimmer 1.5s infinite linear;
        }
    }

    // Responsive adjustments
    @include breakpoint(mobile) {
        &__title {
            @include skeleton-shimmer(90%, 18px, var(--w-border-radius));
        }

        &--mini {
            .movie-card-skeleton__cover-wrap {
                width: 100px;
                height: 56px;
            }

            .movie-card-skeleton__title {
                @include skeleton-shimmer(85%, 14px, var(--w-border-radius));
            }
        }
    }

    // Accessibility: Respect prefers-reduced-motion
    @media (prefers-reduced-motion: reduce) {

        .skeleton-shimmer,
        &__image,
        &__title,
        &__year,
        &__quality {
            animation: none;
            background: var(--w-background-color-dark);
        }

        [data-ww-theme="dark"] & {

            .skeleton-shimmer,
            &__image,
            &__title,
            &__year,
            &__quality {
                background: var(--w-background-color-light);
            }
        }
    }
}